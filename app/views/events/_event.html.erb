<div id="<%= dom_id event %>" 
     data-id="<%= event.id %>" 
     class="group bg-white rounded-xl border border-gray-200 shadow-sm hover:shadow-md hover:-translate-y-1 transition-all duration-200 p-4 cursor-grab active:cursor-grabbing flex flex-col h-full relative overflow-hidden">
  
  <%# Color Configuration %>
  <% is_meal = event.type == 'Meal' %>
  <% badge_class = is_meal ? "bg-emerald-100 text-emerald-800 ring-1 ring-emerald-600/20" : "bg-indigo-100 text-indigo-800 ring-1 ring-indigo-600/20" %>
  
  <%# Header: Title and Type Pill %>
  <div class="flex justify-between items-start gap-3 mb-3">
    <h3 class="text-base font-bold text-gray-900 leading-snug">
      <%= link_to event.title, event_path(event), class: "hover:text-gray-600 transition-colors stretched-link" %>
    </h3>
    <span class="<%= badge_class %> inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium shrink-0">
      <%= event.type %>
    </span>
  </div>

  <%# Meta: Time and Cost %>
  <div class="flex justify-between items-center mb-3">
    <div class="flex items-center text-xs font-medium text-gray-500">
      <svg class="mr-1.5 h-4 w-4 text-gray-400" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <%= event.start_time.strftime("%a, %l:%M %p") %>
    </div>

    <% if event.cost.present? %>
      <div class="font-mono text-xs font-semibold text-gray-700 bg-gray-50 px-2 py-1 rounded border border-gray-100">
        <%= number_to_currency(event.cost) %>
      </div>
    <% end %>
  </div>

  <%# Description %>
  <p class="text-sm text-gray-500 line-clamp-2 mb-4 grow">
    <%= event.description %>
  </p>

  <%# Footer: Actions %>
  <div class="pt-3 border-t border-gray-100 flex items-center justify-between mt-auto relative z-10">
    <div>
      <% if event.status == "planned" %>
        <%= button_to update_status_event_path(event, status: :doing), method: :patch, class: "inline-flex items-center px-2.5 py-1.5 border border-transparent text-xs font-medium rounded text-blue-700 bg-blue-50 hover:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors" do %>
          Start
        <% end %>
      <% elsif event.status == "doing" %>
        <%= button_to update_status_event_path(event, status: :done), method: :patch, class: "inline-flex items-center px-2.5 py-1.5 border border-transparent text-xs font-medium rounded text-emerald-700 bg-emerald-50 hover:bg-emerald-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500 transition-colors" do %>
          Finish
        <% end %>
      <% end %>
    </div>
    
    <%= link_to "Details", event_path(event), class: "text-xs font-medium text-gray-400 hover:text-gray-700 transition-colors" %>
  </div>
</div>
